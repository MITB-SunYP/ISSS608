<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sun Yiping">
<meta name="dcterms.date" content="2024-03-06">

<title>ISSS608 - Prototyping Modules for Visual Analytics Shiny Application</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04c.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04d.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4d</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05c.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05d.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5d</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05e.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5e</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex04/Take-home_Ex04.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 4</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link active" data-scroll-target="#setting-the-scene">1. Setting the Scene</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">1.1 Background</a></li>
  </ul></li>
  <li><a href="#understanding-the-data" id="toc-understanding-the-data" class="nav-link" data-scroll-target="#understanding-the-data">2. Understanding the Data</a>
  <ul class="collapse">
  <li><a href="#installing-and-loading-the-required-libraries" id="toc-installing-and-loading-the-required-libraries" class="nav-link" data-scroll-target="#installing-and-loading-the-required-libraries">2.1 Installing and loading the required libraries</a></li>
  <li><a href="#importing-the-data" id="toc-importing-the-data" class="nav-link" data-scroll-target="#importing-the-data">2.2 Importing the data</a></li>
  <li><a href="#preparing-the-data" id="toc-preparing-the-data" class="nav-link" data-scroll-target="#preparing-the-data">2.3 Preparing the data</a></li>
  </ul></li>
  <li><a href="#explanatory-model" id="toc-explanatory-model" class="nav-link" data-scroll-target="#explanatory-model">3. Explanatory Model</a>
  <ul class="collapse">
  <li><a href="#linear-regression-model-without-transformation" id="toc-linear-regression-model-without-transformation" class="nav-link" data-scroll-target="#linear-regression-model-without-transformation">3.1 Linear Regression Model without Transformation</a></li>
  <li><a href="#linear-regression-with-log-transformation" id="toc-linear-regression-with-log-transformation" class="nav-link" data-scroll-target="#linear-regression-with-log-transformation">3.2 Linear Regression with log transformation</a></li>
  <li><a href="#linear-regression-with-standardization-transformation" id="toc-linear-regression-with-standardization-transformation" class="nav-link" data-scroll-target="#linear-regression-with-standardization-transformation">3.3 Linear Regression with standardization transformation</a></li>
  <li><a href="#linear-regression-with-min-max-transformation" id="toc-linear-regression-with-min-max-transformation" class="nav-link" data-scroll-target="#linear-regression-with-min-max-transformation">3.3 Linear Regression with min-max transformation</a></li>
  <li><a href="#compare-multiple-models" id="toc-compare-multiple-models" class="nav-link" data-scroll-target="#compare-multiple-models">3.4 Compare Multiple Models</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Prototyping Modules for Visual Analytics Shiny Application</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sun Yiping </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 6, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 17, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="setting-the-scene" class="level2">
<h2 class="anchored" data-anchor-id="setting-the-scene">1. Setting the Scene</h2>
<section id="background" class="level3">
<h3 class="anchored" data-anchor-id="background">1.1 Background</h3>
<p>This is the <strong>take home exercise 4 of ISSS608 Visual Analytics and Applications</strong>. In this exercise, we are instructed to develop the prototype for our group Shiny app. Each member of our team needs to pick a module in our Shiny app, and work out the prototype for that module.</p>
<p>Our team chose the topic to study the climate impact in Singapore using the weather data downloaded from <a href="http://www.weather.gov.sg/climate-historical-daily/">Meteorological Service Singapore</a> website and the weekly dengue cases from <a href="https://outbreak.sgcharts.com/data">SGCharts: Outbreak</a>.</p>
<p>The module I have chosen for this take home exercise is to develop an explanatory model to test the impact of the weather data (i.e., temperature, rainfall and wind) on the occurrence of dengue cases in Singapore.</p>
<p>For the interest of this project, we are going to explore the data on a weekly basis at the national level.</p>
</section>
</section>
<section id="understanding-the-data" class="level2">
<h2 class="anchored" data-anchor-id="understanding-the-data">2. Understanding the Data</h2>
<section id="installing-and-loading-the-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="installing-and-loading-the-required-libraries">2.1 Installing and loading the required libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, lubridate, caret, performance, ggstatsplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-the-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-data">2.2 Importing the data</h3>
<section id="weather-data" class="level4">
<h4 class="anchored" data-anchor-id="weather-data">2.2.1 Weather data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>weather <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../Data/clean_climate_data.csv"</span>, <span class="at">na =</span> <span class="st">"."</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(weather, <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 13
   Station     Year Month   Day daily_rainfall highest_30m_rainfall
   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;                &lt;dbl&gt;
 1 Paya Lebar  2003     1     1           31                     NA
 2 Paya Lebar  2003     1     2           28                     NA
 3 Paya Lebar  2003     1     3            1.8                   NA
 4 Paya Lebar  2003     1     4            3.3                   NA
 5 Paya Lebar  2003     1     5            9.3                   NA
 6 Paya Lebar  2003     1     6            0.5                   NA
 7 Paya Lebar  2003     1     7           19.2                   NA
 8 Paya Lebar  2003     1     8           26                     NA
 9 Paya Lebar  2003     1     9            0                     NA
10 Paya Lebar  2003     1    10            0                     NA
# ℹ 7 more variables: highest_60m_rainfall &lt;dbl&gt;, highest_120m_rainfall &lt;dbl&gt;,
#   mean_temp &lt;dbl&gt;, max_temp &lt;dbl&gt;, min_temp &lt;dbl&gt;, mean_wind &lt;dbl&gt;,
#   max_wind &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="dengue-data" class="level4">
<h4 class="anchored" data-anchor-id="dengue-data">2.2.2 Dengue data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dengue <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../Data/weekly_dengue_cases.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dengue, <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
    Year  WkNo Cases
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  2013    20   611
 2  2013    21   640
 3  2013    22   746
 4  2013    23   814
 5  2013    24   810
 6  2013    25   853
 7  2013    26   806
 8  2013    27   678
 9  2013    28   541
10  2013    29   391</code></pre>
</div>
</div>
</section>
</section>
<section id="preparing-the-data" class="level3">
<h3 class="anchored" data-anchor-id="preparing-the-data">2.3 Preparing the data</h3>
<section id="weather-data-1" class="level4">
<h4 class="anchored" data-anchor-id="weather-data-1">2.3.1 Weather Data</h4>
<p>The weather data downloaded from <a href="http://www.weather.gov.sg/climate-historical-daily/">Meteorological Service Singapore</a> website contains the weather information at each weather station. Hence, we use the code chunk below to aggregate the data at national level</p>
<ul>
<li><strong>avg_daily_rainfall</strong>: average daily rainfall among all stations</li>
<li><strong>max_highest_30m_rainfall</strong>: maximum highest 30m rainfall among all stations</li>
<li><strong>max_highest_60m_rainfall</strong>: maximum highest 60m rainfall among all stations</li>
<li><strong>max_highest_120m_rainfall</strong>: maximum highest 120m rainfall among all stations</li>
<li><strong>avg_mean_temp</strong>: average temperature among all stations</li>
<li><strong>max_max_temp</strong>: maximum of highest temperature among all stations</li>
<li><strong>min_min_temp</strong>: minimum of lowest temperature among all stations</li>
<li><strong>avg_mean_wind</strong>: average wind among all stations</li>
<li><strong>max_max_wind</strong>: maximum of maximum wind among all stations</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>weather_group <span class="ot">&lt;-</span> weather <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month, Day) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_daily_rainfall =</span> <span class="fu">mean</span>(daily_rainfall, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_highest_30m_rainfall =</span> <span class="fu">max</span>(highest_30m_rainfall, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_highest_60m_rainfall =</span> <span class="fu">max</span>(highest_60m_rainfall, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_highest_120m_rainfall =</span> <span class="fu">max</span>(highest_120m_rainfall, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_mean_temp =</span> <span class="fu">mean</span>(mean_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_max_temp =</span> <span class="fu">max</span>(max_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_min_temp =</span> <span class="fu">min</span>(min_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_mean_wind =</span> <span class="fu">mean</span>(mean_wind, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_max_wind =</span> <span class="fu">max</span>(max_wind, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(weather_group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Year          Month             Day        avg_daily_rainfall 
 Min.   :2003   Min.   : 1.000   Min.   : 1.00   Min.   :  0.00000  
 1st Qu.:2008   1st Qu.: 4.000   1st Qu.: 8.00   1st Qu.:  0.06667  
 Median :2013   Median : 7.000   Median :16.00   Median :  2.26056  
 Mean   :2013   Mean   : 6.523   Mean   :15.73   Mean   :  6.90035  
 3rd Qu.:2018   3rd Qu.:10.000   3rd Qu.:23.00   3rd Qu.:  9.38194  
 Max.   :2023   Max.   :12.000   Max.   :31.00   Max.   :198.02500  
 max_highest_30m_rainfall max_highest_60m_rainfall max_highest_120m_rainfall
 Min.   :-Inf             Min.   : -Inf            Min.   : -Inf            
 1st Qu.:-Inf             1st Qu.: -Inf            1st Qu.: -Inf            
 Median :-Inf             Median : -Inf            Median : -Inf            
 Mean   :-Inf             Mean   : -Inf            Mean   : -Inf            
 3rd Qu.: 9.2             3rd Qu.: 10.2            3rd Qu.: 10.8            
 Max.   :67.0             Max.   :102.6            Max.   :124.4            
 avg_mean_temp    max_max_temp    min_min_temp   avg_mean_wind   
 Min.   :22.94   Min.   :24.30   Min.   : 0.00   Min.   : 2.800  
 1st Qu.:27.02   1st Qu.:32.10   1st Qu.:22.90   1st Qu.: 6.506  
 Median :27.80   Median :33.20   Median :23.50   Median : 7.656  
 Mean   :27.76   Mean   :32.89   Mean   :23.56   Mean   : 8.130  
 3rd Qu.:28.59   3rd Qu.:34.00   3rd Qu.:24.20   3rd Qu.: 9.300  
 Max.   :30.65   Max.   :38.00   Max.   :27.50   Max.   :21.900  
  max_max_wind   
 Min.   :  9.40  
 1st Qu.: 33.30  
 Median : 41.00  
 Mean   : 42.88  
 3rd Qu.: 49.70  
 Max.   :138.60  </code></pre>
</div>
</div>
<p>Two new columns need to be created before we can aggregate the data at week level:</p>
<ul>
<li><strong>date</strong>: a date variable created from Year, Month and Day columns</li>
<li><strong>wk_no</strong>: calculate the week number using the date column</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>weather_group <span class="ot">&lt;-</span> weather_group <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'date'</span> <span class="ot">=</span> <span class="fu">make_date</span>(<span class="at">year =</span> Year, <span class="at">month =</span> Month, <span class="at">day =</span> Day)) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'wk_no'</span> <span class="ot">=</span> <span class="fu">isoweek</span>(<span class="fu">ymd</span>(date)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now aggregate the data by week:</p>
<ul>
<li><strong>avg_daily_rainfall</strong>: average rainfall in a week. For some reasons, average and sum can’t be calculated under one group_by() command. Hence, the calculation of average rainfall and total rainfall have been divided in two steps.</li>
<li><strong>tot_daily_rainfall</strong>: total rainfall in a week</li>
<li><strong>max_highest_30m_rainfall</strong>: maximum highest 30m rainfall in a week</li>
<li><strong>max_highest_60m_rainfall</strong>: maximum highest 60m rainfall in a week</li>
<li><strong>max_highest_120m_rainfall</strong>: maximum highest 120m rainfall in a week</li>
<li><strong>avg_mean_temp</strong>: average temperature in a week</li>
<li><strong>max_max_temp</strong>: maximum of highest daily temperature in a week</li>
<li><strong>min_min_temp</strong>: minimum of lowest daily temperature in a week</li>
<li><strong>avg_mean_wind</strong>: average wind in a week</li>
<li><strong>max_max_wind</strong>: maximum of maximum daily wind in a week</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>weather_group_wk <span class="ot">&lt;-</span> weather_group <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, wk_no) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tot_daily_rainfall =</span> <span class="fu">sum</span>(avg_daily_rainfall),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_highest_30m_rainfall =</span> <span class="fu">max</span>(max_highest_30m_rainfall),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_highest_60m_rainfall =</span> <span class="fu">max</span>(max_highest_60m_rainfall),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_highest_120m_rainfall =</span> <span class="fu">max</span>(max_highest_120m_rainfall),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_mean_temp =</span> <span class="fu">mean</span>(avg_mean_temp),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_max_temp =</span> <span class="fu">max</span>(max_max_temp),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_min_temp =</span> <span class="fu">min</span>(min_min_temp),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_mean_wind =</span> <span class="fu">mean</span>(avg_mean_wind),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_max_wind =</span> <span class="fu">max</span>(max_max_wind)) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>weather_group_wk <span class="ot">&lt;-</span> weather_group <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, wk_no) <span class="sc">%&gt;%</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_daily_rainfall =</span> <span class="fu">mean</span>(avg_daily_rainfall)) <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(weather_group_wk, <span class="at">by =</span> <span class="fu">join_by</span>(Year, wk_no)) <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(weather_group_wk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Year          wk_no       avg_daily_rainfall tot_daily_rainfall
 Min.   :2003   Min.   : 1.00   Min.   : 0.000     Min.   :  0.00    
 1st Qu.:2008   1st Qu.:14.00   1st Qu.: 3.041     1st Qu.: 21.36    
 Median :2013   Median :27.00   Median : 5.923     Median : 41.39    
 Mean   :2013   Mean   :26.69   Mean   : 6.947     Mean   : 48.11    
 3rd Qu.:2018   3rd Qu.:40.00   3rd Qu.: 9.462     3rd Qu.: 66.16    
 Max.   :2023   Max.   :53.00   Max.   :71.681     Max.   :372.31    
 max_highest_30m_rainfall max_highest_60m_rainfall max_highest_120m_rainfall
 Min.   :-Inf             Min.   : -Inf            Min.   :  -Inf           
 1st Qu.:-Inf             1st Qu.: -Inf            1st Qu.:  -Inf           
 Median :-Inf             Median : -Inf            Median :  -Inf           
 Mean   :-Inf             Mean   : -Inf            Mean   :  -Inf           
 3rd Qu.:34.2             3rd Qu.: 44.4            3rd Qu.: 49.25           
 Max.   :67.0             Max.   :102.6            Max.   :124.40           
 avg_mean_temp    max_max_temp    min_min_temp   avg_mean_wind   
 Min.   :23.85   Min.   :28.00   Min.   : 0.00   Min.   : 4.668  
 1st Qu.:27.18   1st Qu.:33.70   1st Qu.:22.10   1st Qu.: 6.766  
 Median :27.78   Median :34.30   Median :22.50   Median : 7.787  
 Mean   :27.76   Mean   :34.31   Mean   :22.46   Mean   : 8.135  
 3rd Qu.:28.36   3rd Qu.:35.00   3rd Qu.:23.00   3rd Qu.: 9.017  
 Max.   :30.16   Max.   :38.00   Max.   :24.80   Max.   :19.214  
  max_max_wind  
 Min.   : 23.4  
 1st Qu.: 45.0  
 Median : 56.5  
 Mean   : 58.4  
 3rd Qu.: 68.3  
 Max.   :138.6  </code></pre>
</div>
</div>
<p>We can save the weekly weather data in csv file format for future reference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(weather_group_wk, <span class="st">"../../Data/clean_climate_data_by_week.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="join-dengue-data-with-weekly-weather-data" class="level4">
<h4 class="anchored" data-anchor-id="join-dengue-data-with-weekly-weather-data">2.3.2 Join Dengue Data with Weekly Weather Data</h4>
<p>As there are more records in weather data, we will perform a left join using dengue data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dengue_weather_wk <span class="ot">&lt;-</span> dengue <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(weather_group_wk, <span class="at">by =</span> <span class="fu">join_by</span>(Year <span class="sc">==</span> Year, WkNo <span class="sc">==</span> wk_no))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dengue_weather_wk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Year           WkNo           Cases        avg_daily_rainfall
 Min.   :2013   Min.   : 1.00   Min.   :  24.0   Min.   : 0.000    
 1st Qu.:2015   1st Qu.:15.00   1st Qu.:  78.0   1st Qu.: 2.720    
 Median :2017   Median :27.50   Median : 229.5   Median : 5.148    
 Mean   :2017   Mean   :27.13   Mean   : 291.7   Mean   : 5.976    
 3rd Qu.:2019   3rd Qu.:40.00   3rd Qu.: 379.5   3rd Qu.: 8.486    
 Max.   :2020   Max.   :53.00   Max.   :1792.0   Max.   :27.621    
                                                 NA's   :2         
 tot_daily_rainfall max_highest_30m_rainfall max_highest_60m_rainfall
 Min.   :  0.00     Min.   : -Inf            Min.   :  -Inf          
 1st Qu.: 19.04     1st Qu.:20.55            1st Qu.: 24.15          
 Median : 36.03     Median :32.40            Median : 41.60          
 Mean   : 41.91     Mean   : -Inf            Mean   :  -Inf          
 3rd Qu.: 59.40     3rd Qu.:40.00            3rd Qu.: 55.85          
 Max.   :193.35     Max.   :65.20            Max.   :102.60          
 NA's   :2          NA's   :2                NA's   :2               
 max_highest_120m_rainfall avg_mean_temp    max_max_temp   min_min_temp  
 Min.   : -Inf             Min.   :24.56   Min.   :31.0   Min.   : 0.00  
 1st Qu.: 26.2             1st Qu.:27.53   1st Qu.:34.1   1st Qu.:22.10  
 Median : 46.4             Median :28.09   Median :34.7   Median :22.60  
 Mean   : -Inf             Mean   :28.07   Mean   :34.6   Mean   :22.41  
 3rd Qu.: 64.0             3rd Qu.:28.68   3rd Qu.:35.2   3rd Qu.:23.10  
 Max.   :122.8             Max.   :30.09   Max.   :37.5   Max.   :24.80  
 NA's   :2                 NA's   :2       NA's   :2      NA's   :2      
 avg_mean_wind     max_max_wind   
 Min.   : 5.442   Min.   : 35.30  
 1st Qu.: 7.070   1st Qu.: 55.40  
 Median : 8.057   Median : 63.40  
 Mean   : 8.348   Mean   : 66.63  
 3rd Qu.: 9.255   3rd Qu.: 73.17  
 Max.   :14.846   Max.   :138.60  
 NA's   :2        NA's   :2       </code></pre>
</div>
</div>
<p>Remove the rows with no weather data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dengue_weather_wk <span class="ot">&lt;-</span> dengue_weather_wk[<span class="fu">complete.cases</span>(dengue_weather_wk),]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dengue_weather_wk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Year           WkNo           Cases         avg_daily_rainfall
 Min.   :2013   Min.   : 1.00   Min.   :  24.00   Min.   : 0.000    
 1st Qu.:2015   1st Qu.:14.75   1st Qu.:  77.75   1st Qu.: 2.720    
 Median :2017   Median :27.00   Median : 229.50   Median : 5.148    
 Mean   :2017   Mean   :27.00   Mean   : 291.68   Mean   : 5.976    
 3rd Qu.:2019   3rd Qu.:40.00   3rd Qu.: 378.50   3rd Qu.: 8.486    
 Max.   :2020   Max.   :52.00   Max.   :1792.00   Max.   :27.621    
 tot_daily_rainfall max_highest_30m_rainfall max_highest_60m_rainfall
 Min.   :  0.00     Min.   : -Inf            Min.   :  -Inf          
 1st Qu.: 19.04     1st Qu.:20.55            1st Qu.: 24.15          
 Median : 36.03     Median :32.40            Median : 41.60          
 Mean   : 41.91     Mean   : -Inf            Mean   :  -Inf          
 3rd Qu.: 59.40     3rd Qu.:40.00            3rd Qu.: 55.85          
 Max.   :193.35     Max.   :65.20            Max.   :102.60          
 max_highest_120m_rainfall avg_mean_temp    max_max_temp   min_min_temp  
 Min.   : -Inf             Min.   :24.56   Min.   :31.0   Min.   : 0.00  
 1st Qu.: 26.2             1st Qu.:27.53   1st Qu.:34.1   1st Qu.:22.10  
 Median : 46.4             Median :28.09   Median :34.7   Median :22.60  
 Mean   : -Inf             Mean   :28.07   Mean   :34.6   Mean   :22.41  
 3rd Qu.: 64.0             3rd Qu.:28.68   3rd Qu.:35.2   3rd Qu.:23.10  
 Max.   :122.8             Max.   :30.09   Max.   :37.5   Max.   :24.80  
 avg_mean_wind     max_max_wind   
 Min.   : 5.442   Min.   : 35.30  
 1st Qu.: 7.070   1st Qu.: 55.40  
 Median : 8.057   Median : 63.40  
 Mean   : 8.348   Mean   : 66.63  
 3rd Qu.: 9.255   3rd Qu.: 73.17  
 Max.   :14.846   Max.   :138.60  </code></pre>
</div>
</div>
<p>We can save the joined data in csv file format for future reference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(dengue_weather_wk, <span class="st">"../../Data/dengue_climate_joined_by_week.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-transformation" class="level4">
<h4 class="anchored" data-anchor-id="data-transformation">2.3.3 Data Transformation</h4>
<p>We’ll then perform the following transformations and add the corresponding transformed columns in the dataset:</p>
<ul>
<li><strong>log transformation</strong>: log1p() is used instead of log() is to deal with rows having value of 0</li>
<li><strong>standardization</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dengue_weather_wk_tf <span class="ot">&lt;-</span> dengue_weather_wk <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_cases =</span> <span class="fu">log1p</span>(Cases),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_avg_daily_rainfall =</span> <span class="fu">log1p</span>(avg_daily_rainfall),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_tot_daily_rainfall =</span> <span class="fu">log1p</span>(tot_daily_rainfall),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_max_highest_30m_rainfall =</span> <span class="fu">log1p</span>(max_highest_30m_rainfall),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_max_highest_60m_rainfall =</span> <span class="fu">log1p</span>(max_highest_60m_rainfall),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_max_highest_120m_rainfall =</span> <span class="fu">log1p</span>(max_highest_120m_rainfall),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_avg_mean_temp =</span> <span class="fu">log1p</span>(avg_mean_temp),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_max_max_temp =</span> <span class="fu">log1p</span>(max_max_temp),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_min_min_temp =</span> <span class="fu">log1p</span>(min_min_temp),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_avg_mean_wind =</span> <span class="fu">log1p</span>(avg_mean_wind),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_max_max_wind =</span> <span class="fu">log1p</span>(max_max_wind),</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_cases =</span> <span class="fu">scale</span>(Cases),</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_avg_daily_rainfall =</span> <span class="fu">scale</span>(avg_daily_rainfall),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_tot_daily_rainfall =</span> <span class="fu">scale</span>(tot_daily_rainfall),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_avg_mean_temp =</span> <span class="fu">scale</span>(avg_mean_temp),</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_max_max_temp =</span> <span class="fu">scale</span>(max_max_temp),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_min_min_temp =</span> <span class="fu">scale</span>(min_min_temp),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_avg_mean_wind =</span> <span class="fu">scale</span>(avg_mean_wind),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_max_max_wind =</span> <span class="fu">scale</span>(max_max_wind))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next we use the preprocess() function from caret package to perform min-max transformation on the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>minmax_data <span class="ot">&lt;-</span> dengue_weather_wk <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"max_highest_30m_rainfall"</span>, <span class="st">"max_highest_60m_rainfall"</span>, <span class="st">"max_highest_120m_rainfall"</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#minmax_preprocess &lt;- preProcess(minmax_data, method = c("range"))</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>minmax_preprocess <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(minmax_data, <span class="at">method =</span> <span class="fu">list</span>(<span class="at">range =</span> <span class="fu">names</span>(minmax_data)[<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>]))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>minmax_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(minmax_preprocess, minmax_data)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(minmax_result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Year"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"WkNo"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"mm_Cases"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"mm_avg_daily_rainfall"</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"mm_tot_daily_rainfall"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"mm_avg_mean_temp"</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"mm_max_max_temp"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"mm_min_min_temp"</span>,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"mm_avg_mean_wind"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"mm_max_max_wind"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then add the min-max transformed columns to the main dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dengue_weather_wk_tf <span class="ot">&lt;-</span> dengue_weather_wk_tf <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(minmax_result, <span class="at">by =</span> <span class="fu">join_by</span>(Year, WkNo))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dengue_weather_wk_tf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Year           WkNo           Cases         avg_daily_rainfall
 Min.   :2013   Min.   : 1.00   Min.   :  24.00   Min.   : 0.000    
 1st Qu.:2015   1st Qu.:14.75   1st Qu.:  77.75   1st Qu.: 2.720    
 Median :2017   Median :27.00   Median : 229.50   Median : 5.148    
 Mean   :2017   Mean   :27.00   Mean   : 291.68   Mean   : 5.976    
 3rd Qu.:2019   3rd Qu.:40.00   3rd Qu.: 378.50   3rd Qu.: 8.486    
 Max.   :2020   Max.   :52.00   Max.   :1792.00   Max.   :27.621    
                                                                    
 tot_daily_rainfall max_highest_30m_rainfall max_highest_60m_rainfall
 Min.   :  0.00     Min.   : -Inf            Min.   :  -Inf          
 1st Qu.: 19.04     1st Qu.:20.55            1st Qu.: 24.15          
 Median : 36.03     Median :32.40            Median : 41.60          
 Mean   : 41.91     Mean   : -Inf            Mean   :  -Inf          
 3rd Qu.: 59.40     3rd Qu.:40.00            3rd Qu.: 55.85          
 Max.   :193.35     Max.   :65.20            Max.   :102.60          
                                                                     
 max_highest_120m_rainfall avg_mean_temp    max_max_temp   min_min_temp  
 Min.   : -Inf             Min.   :24.56   Min.   :31.0   Min.   : 0.00  
 1st Qu.: 26.2             1st Qu.:27.53   1st Qu.:34.1   1st Qu.:22.10  
 Median : 46.4             Median :28.09   Median :34.7   Median :22.60  
 Mean   : -Inf             Mean   :28.07   Mean   :34.6   Mean   :22.41  
 3rd Qu.: 64.0             3rd Qu.:28.68   3rd Qu.:35.2   3rd Qu.:23.10  
 Max.   :122.8             Max.   :30.09   Max.   :37.5   Max.   :24.80  
                                                                         
 avg_mean_wind     max_max_wind      log_cases     log_avg_daily_rainfall
 Min.   : 5.442   Min.   : 35.30   Min.   :3.219   Min.   :0.000         
 1st Qu.: 7.070   1st Qu.: 55.40   1st Qu.:4.366   1st Qu.:1.314         
 Median : 8.057   Median : 63.40   Median :5.440   Median :1.816         
 Mean   : 8.348   Mean   : 66.63   Mean   :5.272   Mean   :1.713         
 3rd Qu.: 9.255   3rd Qu.: 73.17   3rd Qu.:5.939   3rd Qu.:2.250         
 Max.   :14.846   Max.   :138.60   Max.   :7.492   Max.   :3.354         
                                                                         
 log_tot_daily_rainfall log_max_highest_30m_rainfall
 Min.   :0.000          Min.   :0.000               
 1st Qu.:2.998          1st Qu.:3.231               
 Median :3.612          Median :3.550               
 Mean   :3.373          Mean   :3.349               
 3rd Qu.:4.101          3rd Qu.:3.731               
 Max.   :5.270          Max.   :4.193               
                        NA's   :33                  
 log_max_highest_60m_rainfall log_max_highest_120m_rainfall log_avg_mean_temp
 Min.   :0.000                Min.   :0.000                 Min.   :3.241    
 1st Qu.:3.466                1st Qu.:3.550                 1st Qu.:3.351    
 Median :3.798                Median :3.900                 Median :3.370    
 Mean   :3.589                Mean   :3.696                 Mean   :3.369    
 3rd Qu.:4.057                3rd Qu.:4.190                 3rd Qu.:3.390    
 Max.   :4.641                Max.   :4.819                 Max.   :3.437    
 NA's   :33                   NA's   :33                                     
 log_max_max_temp log_min_min_temp log_avg_mean_wind log_max_max_wind
 Min.   :3.466    Min.   :0.000    Min.   :1.863     Min.   :3.592   
 1st Qu.:3.558    1st Qu.:3.140    1st Qu.:2.088     1st Qu.:4.032   
 Median :3.575    Median :3.161    Median :2.204     Median :4.165   
 Mean   :3.572    Mean   :3.136    Mean   :2.219     Mean   :4.188   
 3rd Qu.:3.589    3rd Qu.:3.182    3rd Qu.:2.328     3rd Qu.:4.306   
 Max.   :3.651    Max.   :3.250    Max.   :2.763     Max.   :4.939   
                                                                     
     z_cases.V1      z_avg_daily_rainfall.V1 z_tot_daily_rainfall.V1
 Min.   :-0.944070   Min.   :-1.356442       Min.   :-1.352349      
 1st Qu.:-0.754502   1st Qu.:-0.739108       1st Qu.:-0.737984      
 Median :-0.219303   Median :-0.188006       Median :-0.189533      
 Mean   : 0.000000   Mean   : 0.000000       Mean   : 0.000000      
 3rd Qu.: 0.306197   3rd Qu.: 0.569720       3rd Qu.: 0.564550      
 Max.   : 5.291392   Max.   : 4.913223       Max.   : 4.887166      
                                                                    
 z_avg_mean_temp.V1   z_max_max_temp.V1   z_min_min_temp.V1  
 Min.   :-4.202192   Min.   :-4.057361   Min.   :-10.554820  
 1st Qu.:-0.645443   1st Qu.:-0.559805   1st Qu.: -0.146930  
 Median : 0.021603   Median : 0.117142   Median :  0.088543  
 Mean   : 0.000000   Mean   : 0.000000   Mean   :  0.000000  
 3rd Qu.: 0.719704   3rd Qu.: 0.681264   3rd Qu.:  0.324015  
 Max.   : 2.408351   Max.   : 3.276225   Max.   :  1.124622  
                                                             
 z_avg_mean_wind.V1   z_max_max_wind.V1     mm_Cases      mm_avg_daily_rainfall
 Min.   :-1.664669   Min.   :-1.916568   Min.   :0.0000   Min.   :0.00000      
 1st Qu.:-0.731889   1st Qu.:-0.687113   1st Qu.:0.0304   1st Qu.:0.09846      
 Median :-0.166464   Median :-0.197778   Median :0.1162   Median :0.18636      
 Mean   : 0.000000   Mean   : 0.000000   Mean   :0.1514   Mean   :0.21635      
 3rd Qu.: 0.519948   3rd Qu.: 0.400128   3rd Qu.:0.2005   3rd Qu.:0.30722      
 Max.   : 3.722729   Max.   : 4.401973   Max.   :1.0000   Max.   :1.00000      
                                                                               
 mm_tot_daily_rainfall mm_avg_mean_temp mm_max_max_temp  mm_min_min_temp 
 Min.   :0.00000       Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.09846       1st Qu.:0.5380   1st Qu.:0.4769   1st Qu.:0.8911  
 Median :0.18636       Median :0.6389   Median :0.5692   Median :0.9113  
 Mean   :0.21674       Mean   :0.6357   Mean   :0.5533   Mean   :0.9037  
 3rd Qu.:0.30722       3rd Qu.:0.7446   3rd Qu.:0.6462   3rd Qu.:0.9315  
 Max.   :1.00000       Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
                                                                         
 mm_avg_mean_wind mm_max_max_wind 
 Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.1731   1st Qu.:0.1946  
 Median :0.2781   Median :0.2720  
 Mean   :0.3090   Mean   :0.3033  
 3rd Qu.:0.4055   3rd Qu.:0.3667  
 Max.   :1.0000   Max.   :1.0000  
                                  </code></pre>
</div>
</div>
<p>We can save the data with transformation in csv file format for future reference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dengue_weather_wk_tf, <span class="st">"../../Data/dengue_climate_joined_by_week_transformed.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="explanatory-model" class="level2">
<h2 class="anchored" data-anchor-id="explanatory-model">3. Explanatory Model</h2>
<section id="linear-regression-model-without-transformation" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression-model-without-transformation">3.1 Linear Regression Model without Transformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear regression model using all the data without normalization</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>lm_nf_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Cases <span class="sc">~</span> avg_daily_rainfall <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                  tot_daily_rainfall <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                  avg_mean_temp <span class="sc">+</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                  max_max_temp <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                  min_min_temp <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                  avg_mean_wind <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                  max_max_wind, <span class="at">data =</span> dengue_weather_wk_tf)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_nf_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Cases ~ avg_daily_rainfall + tot_daily_rainfall + 
    avg_mean_temp + max_max_temp + min_min_temp + avg_mean_wind + 
    max_max_wind, data = dengue_weather_wk_tf)

Residuals:
    Min      1Q  Median      3Q     Max 
-388.19 -167.00  -52.92   85.50 1467.96 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        -903.0262   716.5219  -1.260  0.20833    
avg_daily_rainfall  114.3264    97.7320   1.170  0.24281    
tot_daily_rainfall  -14.6723    13.8930  -1.056  0.29159    
avg_mean_temp       105.4545    23.8501   4.422 1.28e-05 ***
max_max_temp        -58.7096    20.0177  -2.933  0.00356 ** 
min_min_temp          3.3374     6.7304   0.496  0.62027    
avg_mean_wind        18.8495     9.8953   1.905  0.05754 .  
max_max_wind         -0.5278     0.9016  -0.585  0.55857    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 277.4 on 384 degrees of freedom
Multiple R-squared:  0.05986,   Adjusted R-squared:  0.04273 
F-statistic: 3.493 on 7 and 384 DF,  p-value: 0.001207</code></pre>
</div>
</div>
<p>Check the model statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm_nf_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<p>Average daily rainfall and total rain fall are highly correlated. We shall retain the total rainfall variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>lm_nf_m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Cases <span class="sc">~</span> tot_daily_rainfall <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                  avg_mean_temp <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                  max_max_temp <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                  min_min_temp <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                  avg_mean_wind <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                  max_max_wind, <span class="at">data =</span> dengue_weather_wk_tf)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Backward stepwise regression</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>lm_nf_m2_bw <span class="ot">&lt;-</span> <span class="fu">step</span>(lm_nf_m2, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4417.72
Cases ~ tot_daily_rainfall + avg_mean_temp + max_max_temp + min_min_temp + 
    avg_mean_wind + max_max_wind

                     Df Sum of Sq      RSS    AIC
- min_min_temp        1     17505 29675338 4415.9
- max_max_wind        1     22337 29680171 4416.0
&lt;none&gt;                            29657834 4417.7
- avg_mean_wind       1    269020 29926854 4419.3
- tot_daily_rainfall  1    454962 30112795 4421.7
- max_max_temp        1    629941 30287774 4424.0
- avg_mean_temp       1   1495433 31153266 4435.0

Step:  AIC=4415.95
Cases ~ tot_daily_rainfall + avg_mean_temp + max_max_temp + avg_mean_wind + 
    max_max_wind

                     Df Sum of Sq      RSS    AIC
- max_max_wind        1     25867 29701205 4414.3
&lt;none&gt;                            29675338 4415.9
- avg_mean_wind       1    283377 29958715 4417.7
- tot_daily_rainfall  1    468397 30143735 4420.1
- max_max_temp        1    624858 30300197 4422.1
- avg_mean_temp       1   1557693 31233031 4434.0

Step:  AIC=4414.29
Cases ~ tot_daily_rainfall + avg_mean_temp + max_max_temp + avg_mean_wind

                     Df Sum of Sq      RSS    AIC
&lt;none&gt;                            29701205 4414.3
- avg_mean_wind       1    291241 29992446 4416.1
- tot_daily_rainfall  1    442715 30143920 4418.1
- max_max_temp        1    636912 30338118 4420.6
- avg_mean_temp       1   1537560 31238765 4432.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_nf_m2_bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Cases ~ tot_daily_rainfall + avg_mean_temp + max_max_temp + 
    avg_mean_wind, data = dengue_weather_wk_tf)

Residuals:
    Min      1Q  Median      3Q     Max 
-391.47 -172.34  -55.57   91.18 1478.24 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        -909.4370   712.9637  -1.276  0.20287    
tot_daily_rainfall    1.5018     0.6253   2.402  0.01679 *  
avg_mean_temp       105.5657    23.5851   4.476    1e-05 ***
max_max_temp        -57.3853    19.9201  -2.881  0.00419 ** 
avg_mean_wind        19.1489     9.8299   1.948  0.05213 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 277 on 387 degrees of freedom
Multiple R-squared:  0.05513,   Adjusted R-squared:  0.04537 
F-statistic: 5.646 on 4 and 387 DF,  p-value: 2e-04</code></pre>
</div>
</div>
<p>Check the model statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm_nf_m2_bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="linear-regression-with-log-transformation" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression-with-log-transformation">3.2 Linear Regression with log transformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear regression model using all the data with log transformation</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>lm_log_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_cases <span class="sc">~</span> log_tot_daily_rainfall <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                  log_avg_mean_temp <span class="sc">+</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                  log_max_max_temp <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                  log_min_min_temp <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                  log_avg_mean_wind <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                  log_max_max_wind, <span class="at">data =</span> dengue_weather_wk_tf)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_log_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_cases ~ log_tot_daily_rainfall + log_avg_mean_temp + 
    log_max_max_temp + log_min_min_temp + log_avg_mean_wind + 
    log_max_max_wind, data = dengue_weather_wk_tf)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8972 -0.7954  0.1677  0.6609  2.2296 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            -9.07402    7.55032  -1.202 0.230177    
log_tot_daily_rainfall  0.05977    0.06011   0.994 0.320719    
log_avg_mean_temp       7.51679    2.14357   3.507 0.000507 ***
log_max_max_temp       -3.59951    2.38016  -1.512 0.131279    
log_min_min_temp        0.12649    0.16997   0.744 0.457195    
log_avg_mean_wind       0.54012    0.33561   1.609 0.108353    
log_max_max_wind        0.01888    0.22657   0.083 0.933631    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9298 on 385 degrees of freedom
Multiple R-squared:  0.04077,   Adjusted R-squared:  0.02582 
F-statistic: 2.727 on 6 and 385 DF,  p-value: 0.01318</code></pre>
</div>
</div>
<p>Backward stepwise regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>lm_log_m1_bw <span class="ot">&lt;-</span> <span class="fu">step</span>(lm_log_m1, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-50.11
log_cases ~ log_tot_daily_rainfall + log_avg_mean_temp + log_max_max_temp + 
    log_min_min_temp + log_avg_mean_wind + log_max_max_wind

                         Df Sum of Sq    RSS     AIC
- log_max_max_wind        1    0.0060 332.86 -52.102
- log_min_min_temp        1    0.4789 333.34 -51.546
- log_tot_daily_rainfall  1    0.8547 333.71 -51.104
&lt;none&gt;                                332.86 -50.110
- log_max_max_temp        1    1.9773 334.84 -49.788
- log_avg_mean_wind       1    2.2393 335.10 -49.481
- log_avg_mean_temp       1   10.6314 343.49 -39.785

Step:  AIC=-52.1
log_cases ~ log_tot_daily_rainfall + log_avg_mean_temp + log_max_max_temp + 
    log_min_min_temp + log_avg_mean_wind

                         Df Sum of Sq    RSS     AIC
- log_min_min_temp        1    0.4747 333.34 -53.544
- log_tot_daily_rainfall  1    0.9710 333.84 -52.961
&lt;none&gt;                                332.86 -52.102
- log_max_max_temp        1    1.9737 334.84 -51.785
- log_avg_mean_wind       1    2.2422 335.11 -51.471
- log_avg_mean_temp       1   10.6954 343.56 -41.705

Step:  AIC=-53.54
log_cases ~ log_tot_daily_rainfall + log_avg_mean_temp + log_max_max_temp + 
    log_avg_mean_wind

                         Df Sum of Sq    RSS     AIC
- log_tot_daily_rainfall  1    0.9901 334.33 -54.381
&lt;none&gt;                                333.34 -53.544
- log_max_max_temp        1    1.9289 335.27 -53.282
- log_avg_mean_wind       1    2.3541 335.69 -52.785
- log_avg_mean_temp       1   10.8233 344.16 -43.018

Step:  AIC=-54.38
log_cases ~ log_avg_mean_temp + log_max_max_temp + log_avg_mean_wind

                    Df Sum of Sq    RSS     AIC
- log_avg_mean_wind  1    1.3744 335.70 -54.773
&lt;none&gt;                           334.33 -54.381
- log_max_max_temp   1    1.8541 336.18 -54.213
- log_avg_mean_temp  1    9.8333 344.16 -45.018

Step:  AIC=-54.77
log_cases ~ log_avg_mean_temp + log_max_max_temp

                    Df Sum of Sq    RSS     AIC
&lt;none&gt;                           335.70 -54.773
- log_max_max_temp   1    2.6617 338.37 -53.677
- log_avg_mean_temp  1   11.1170 346.82 -44.002</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_log_m1_bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_cases ~ log_avg_mean_temp + log_max_max_temp, 
    data = dengue_weather_wk_tf)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8753 -0.7805  0.1471  0.6921  2.2518 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -4.493      6.943  -0.647 0.517920    
log_avg_mean_temp    7.231      2.015   3.589 0.000374 ***
log_max_max_temp    -4.087      2.327  -1.756 0.079842 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.929 on 389 degrees of freedom
Multiple R-squared:  0.03257,   Adjusted R-squared:  0.0276 
F-statistic: 6.549 on 2 and 389 DF,  p-value: 0.001595</code></pre>
</div>
</div>
<p>Check the model statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm_log_m1_bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="linear-regression-with-standardization-transformation" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression-with-standardization-transformation">3.3 Linear Regression with standardization transformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear regression model using all the data with standardization transformation</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>lm_z_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(z_cases <span class="sc">~</span> z_tot_daily_rainfall <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                  z_avg_mean_temp <span class="sc">+</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                  z_max_max_temp <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                  z_min_min_temp <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                  z_avg_mean_wind <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                  z_max_max_wind, <span class="at">data =</span> dengue_weather_wk_tf)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_z_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = z_cases ~ z_tot_daily_rainfall + z_avg_mean_temp + 
    z_max_max_temp + z_min_min_temp + z_avg_mean_wind + z_max_max_wind, 
    data = dengue_weather_wk_tf)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.3696 -0.5930 -0.1819  0.3062  5.1818 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          -4.275e-16  4.944e-02   0.000  1.00000    
z_tot_daily_rainfall  1.707e-01  7.025e-02   2.430  0.01555 *  
z_avg_mean_temp       3.102e-01  7.040e-02   4.406 1.37e-05 ***
z_max_max_temp       -1.786e-01  6.246e-02  -2.860  0.00447 ** 
z_min_min_temp        2.404e-02  5.042e-02   0.477  0.63385    
z_avg_mean_wind       1.138e-01  6.092e-02   1.869  0.06242 .  
z_max_max_wind       -2.798e-02  5.197e-02  -0.538  0.59055    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9789 on 385 degrees of freedom
Multiple R-squared:  0.05651,   Adjusted R-squared:  0.04181 
F-statistic: 3.844 on 6 and 385 DF,  p-value: 0.0009773</code></pre>
</div>
</div>
<p>Backward stepwise regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>lm_z_m1_bw <span class="ot">&lt;-</span> <span class="fu">step</span>(lm_z_m1, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-9.81
z_cases ~ z_tot_daily_rainfall + z_avg_mean_temp + z_max_max_temp + 
    z_min_min_temp + z_avg_mean_wind + z_max_max_wind

                       Df Sum of Sq    RSS      AIC
- z_min_min_temp        1    0.2177 369.12 -11.5741
- z_max_max_wind        1    0.2778 369.18 -11.5103
&lt;none&gt;                              368.90  -9.8054
- z_avg_mean_wind       1    3.3462 372.25  -8.2657
- z_tot_daily_rainfall  1    5.6591 374.56  -5.8377
- z_max_max_temp        1    7.8356 376.74  -3.5664
- z_avg_mean_temp       1   18.6011 387.50   7.4782

Step:  AIC=-11.57
z_cases ~ z_tot_daily_rainfall + z_avg_mean_temp + z_max_max_temp + 
    z_avg_mean_wind + z_max_max_wind

                       Df Sum of Sq    RSS      AIC
- z_max_max_wind        1    0.3217 369.44 -13.2326
&lt;none&gt;                              369.12 -11.5741
- z_avg_mean_wind       1    3.5248 372.65  -9.8486
- z_tot_daily_rainfall  1    5.8262 374.95  -7.4351
- z_max_max_temp        1    7.7724 376.89  -5.4057
- z_avg_mean_temp       1   19.3756 388.50   6.4805

Step:  AIC=-13.23
z_cases ~ z_tot_daily_rainfall + z_avg_mean_temp + z_max_max_temp + 
    z_avg_mean_wind

                       Df Sum of Sq    RSS      AIC
&lt;none&gt;                              369.44 -13.2326
- z_avg_mean_wind       1    3.6226 373.07 -11.4075
- z_tot_daily_rainfall  1    5.5068 374.95  -9.4327
- z_max_max_temp        1    7.9223 377.36  -6.9154
- z_avg_mean_temp       1   19.1252 388.57   4.5525</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_z_m1_bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = z_cases ~ z_tot_daily_rainfall + z_avg_mean_temp + 
    z_max_max_temp + z_avg_mean_wind, data = dengue_weather_wk_tf)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.3807 -0.6078 -0.1960  0.3216  5.2135 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          -4.221e-16  4.935e-02   0.000  1.00000    
z_tot_daily_rainfall  1.641e-01  6.833e-02   2.402  0.01679 *  
z_avg_mean_temp       3.115e-01  6.959e-02   4.476    1e-05 ***
z_max_max_temp       -1.794e-01  6.227e-02  -2.881  0.00419 ** 
z_avg_mean_wind       1.179e-01  6.052e-02   1.948  0.05213 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9771 on 387 degrees of freedom
Multiple R-squared:  0.05513,   Adjusted R-squared:  0.04537 
F-statistic: 5.646 on 4 and 387 DF,  p-value: 2e-04</code></pre>
</div>
</div>
<p>Check the model statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm_z_m1_bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="linear-regression-with-min-max-transformation" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression-with-min-max-transformation">3.3 Linear Regression with min-max transformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear regression model using all the data with min-max transformation</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>lm_mm_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mm_Cases <span class="sc">~</span> mm_tot_daily_rainfall <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                  mm_avg_mean_temp <span class="sc">+</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                  mm_max_max_temp <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                  mm_min_min_temp <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                  mm_avg_mean_wind <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>                  mm_max_max_wind, <span class="at">data =</span> dengue_weather_wk_tf)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_mm_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mm_Cases ~ mm_tot_daily_rainfall + mm_avg_mean_temp + 
    mm_max_max_temp + mm_min_min_temp + mm_avg_mean_wind + mm_max_max_wind, 
    data = dengue_weather_wk_tf)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.21964 -0.09510 -0.02916  0.04911  0.83103 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -0.04090    0.09971  -0.410  0.68190    
mm_tot_daily_rainfall  0.17085    0.07030   2.430  0.01555 *  
mm_avg_mean_temp       0.32882    0.07463   4.406 1.37e-05 ***
mm_max_max_temp       -0.21008    0.07346  -2.860  0.00447 ** 
mm_min_min_temp        0.04502    0.09444   0.477  0.63385    
mm_avg_mean_wind       0.09836    0.05263   1.869  0.06242 .  
mm_max_max_wind       -0.02836    0.05266  -0.538  0.59055    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.157 on 385 degrees of freedom
Multiple R-squared:  0.05651,   Adjusted R-squared:  0.04181 
F-statistic: 3.844 on 6 and 385 DF,  p-value: 0.0009773</code></pre>
</div>
</div>
<p>Backward stepwise regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>lm_mm_m1_bw <span class="ot">&lt;-</span> <span class="fu">step</span>(lm_mm_m1, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-1444.72
mm_Cases ~ mm_tot_daily_rainfall + mm_avg_mean_temp + mm_max_max_temp + 
    mm_min_min_temp + mm_avg_mean_wind + mm_max_max_wind

                        Df Sum of Sq    RSS     AIC
- mm_min_min_temp        1   0.00560 9.4936 -1446.5
- mm_max_max_wind        1   0.00715 9.4952 -1446.4
&lt;none&gt;                               9.4880 -1444.7
- mm_avg_mean_wind       1   0.08606 9.5741 -1443.2
- mm_tot_daily_rainfall  1   0.14555 9.6336 -1440.8
- mm_max_max_temp        1   0.20153 9.6895 -1438.5
- mm_avg_mean_temp       1   0.47841 9.9664 -1427.4

Step:  AIC=-1446.49
mm_Cases ~ mm_tot_daily_rainfall + mm_avg_mean_temp + mm_max_max_temp + 
    mm_avg_mean_wind + mm_max_max_wind

                        Df Sum of Sq    RSS     AIC
- mm_max_max_wind        1   0.00828 9.5019 -1448.2
&lt;none&gt;                               9.4936 -1446.5
- mm_avg_mean_wind       1   0.09066 9.5843 -1444.8
- mm_tot_daily_rainfall  1   0.14985 9.6435 -1442.3
- mm_max_max_temp        1   0.19990 9.6935 -1440.3
- mm_avg_mean_temp       1   0.49833 9.9919 -1428.4

Step:  AIC=-1448.15
mm_Cases ~ mm_tot_daily_rainfall + mm_avg_mean_temp + mm_max_max_temp + 
    mm_avg_mean_wind

                        Df Sum of Sq    RSS     AIC
&lt;none&gt;                               9.5019 -1448.2
- mm_avg_mean_wind       1   0.09317 9.5951 -1446.3
- mm_tot_daily_rainfall  1   0.14163 9.6435 -1444.3
- mm_max_max_temp        1   0.20376 9.7056 -1441.8
- mm_avg_mean_temp       1   0.49189 9.9938 -1430.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_mm_m1_bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mm_Cases ~ mm_tot_daily_rainfall + mm_avg_mean_temp + 
    mm_max_max_temp + mm_avg_mean_wind, data = dengue_weather_wk_tf)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.22142 -0.09748 -0.03143  0.05157  0.83611 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -0.008838   0.062128  -0.142  0.88695    
mm_tot_daily_rainfall  0.164229   0.068378   2.402  0.01679 *  
mm_avg_mean_temp       0.330195   0.073771   4.476    1e-05 ***
mm_max_max_temp       -0.210975   0.073236  -2.881  0.00419 ** 
mm_avg_mean_wind       0.101853   0.052285   1.948  0.05213 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1567 on 387 degrees of freedom
Multiple R-squared:  0.05513,   Adjusted R-squared:  0.04537 
F-statistic: 5.646 on 4 and 387 DF,  p-value: 2e-04</code></pre>
</div>
</div>
<p>Check the model statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm_mm_m1_bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="compare-multiple-models" class="level3">
<h3 class="anchored" data-anchor-id="compare-multiple-models">3.4 Compare Multiple Models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(lm_nf_m2_bw, lm_log_m1_bw, lm_z_m1_bw, lm_mm_m1_bw, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name         | Model |    R2 | R2 (adj.) |    RMSE |   Sigma | AIC weights | AICc weights | BIC weights | Performance-Score
---------------------------------------------------------------------------------------------------------------------------
lm_mm_m1_bw  |    lm | 0.055 |     0.045 |   0.156 |   0.157 |        1.00 |         1.00 |        1.00 |           100.00%
lm_z_m1_bw   |    lm | 0.055 |     0.045 |   0.971 |   0.977 |   2.58e-312 |    2.58e-312 |   2.58e-312 |            57.06%
lm_nf_m2_bw  |    lm | 0.055 |     0.045 | 275.261 | 277.033 |    0.00e+00 |     0.00e+00 |    0.00e+00 |            28.57%
lm_log_m1_bw |    lm | 0.033 |     0.028 |   0.925 |   0.929 |   2.70e-303 |    2.86e-303 |   1.43e-301 |            28.49%</code></pre>
</div>
</div>
<p>From the comparison table above, the linear regression model with min-max transformation has the highest R^2. Therefore, this model would be chosen as the best model among the four models calibrated.</p>
<p>Let’s visualize the coefficients.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoefstats</span>(lm_mm_m1_bw, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">output =</span> <span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>